#!/bin/bash
cd /Dedicated/jmichaelson-wdata/lcasten/tools/PRSice

conda activate RERCONVERGE

Rscript PRSice.R --prsice PRSice_linux \
    --base /Dedicated/jmichaelson-wdata/lcasten/spark/prs/pathway/cogPerf_SSGAC2018_sumstats_mapped_to_SPARK_and_ABCD_SNP_id.tsv \
    --target /Dedicated/jmichaelson-wdata/lcasten/spark_abcd_array_merge/topmed_hg19/autosomes.qc \
    --ld-keep /Dedicated/jmichaelson-wdata/lcasten/spark/prs/pathway/SPARK_ABCD_unrelated_europeans_for_LD.txt \
    --binary-target T \
    --bar-levels 1 --fastscore --no-regress --thread 100 \
    --bed /Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/phastConsElements_vertebrates.160-400_mya.bed:consVertebrates_160-400mya,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/phastConsElements_placental_mammals.100_mya.bed:consMammals_100mya,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/phastConsElements_primates.65_mya.bed:consPrimates_65mya,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/primate_conserved_exons.hg19.bed:consPrimate_exons,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/primate_UCE.hg19.bed:consPrimates_UCE,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Catarrhini.bed:LinAR_Catarrhini,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Hominidae.bed:LinAR_Hominidae,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Homininae.bed:LinAR_Homininae,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Hominoidea.bed:LinAR_Hominoidea,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Human.bed:LinAR_Human,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Simiformes.bed:LinAR_Simiformes,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/singleton_density_score_top5pct.bed:human_singleton_density_score_top5pct,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/human_chimp_divergence_DMG.bed:human_chimp_div_DMG,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/neanderthal_selective_sweep.bed:NeanderthalSelectiveSweep,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/HAQERs.bed:HAQER,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/HARs.bed:HAR,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/introgressed_SNPs.bed:archaic_introgression,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/neanderthal_introgressed_SNPs.bed:neanderthal_introgression,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_human_chimp_divergence_DMG.bed:complement_human_chimp_div_DMG,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_neanderthal_selective_sweep.bed:complement_NeanderthalSelectiveSweep,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_HAQERs.bed:complement_HAQER,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_HARs.bed:complement_HAR,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_introgressed_SNPs.bed:complement_archaic_introgression,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_neanderthal_introgressed_SNPs.bed:complement_neanderthal_introgression,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_phastConsElements_vertebrates.160-400_mya.bed:complement_consVertebrates_160-400mya,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_phastConsElements_placental_mammals.100_mya.bed:complement_consMammals_100mya,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_phastConsElements_primates.65_mya.bed:complement_consPrimates_65mya,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_primate_conserved_exons.hg19.bed:complement_consPrimate_exons,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_primate_UCE.hg19.bed:complement_consPrimates_UCE,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_singleton_density_score_top5pct.bed:complement_human_singleton_density_score_top5pct,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_LinAR_Catarrhini.bed:complement_LinAR_Catarrhini,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_LinAR_Hominidae.bed:complement_LinAR_Hominidae,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_LinAR_Homininae.bed:complement_LinAR_Homininae,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_LinAR_Hominoidea.bed:complement_LinAR_Hominoidea,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_LinAR_Human.bed:complement_LinAR_Human,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_LinAR_Simiformes.bed:complement_LinAR_Simiformes,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/neanderthal_introgression_Iasi2024.bed:neanderthal_introgressed_regions_Iasi2024,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_neanderthal_introgression_Iasi2024.bed:complement_neanderthal_introgressed_regions_Iasi2024,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/chimp-AQERs.bed:CAQERs,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_chimp-AQERs.bed:complement_CAQERs,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/gorilla-AQERs.bed:GAQERs,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_gorilla-AQERs.bed:complement_GAQERs,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/singleton_density_score_top1pct.bed:SDS_top_1pct,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_singleton_density_score_top1pct.bed:complement_SDS_top_1pct,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/HAQERs_v2.hg19.bed:HAQER_v2,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_HAQERs_v2.hg19.bed:complement_HAQER_v2,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/ancient_human_selective_sweep.bed:ancient_human_selective_sweep,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/complement_ancient_human_selective_sweep.bed:complement_ancient_human_selective_sweep,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/ancient_human_selective_sweep.matched_control_sequences.bed:random_matched_control_ancient_human_selective_sweep,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/human_chimp_divergence_DMG.matched_control_sequences.bed:random_matched_control_human_chimp_div_DMG,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/HAQERs.matched_control_sequences.bed:random_matched_control_HAQER,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/HARs.matched_control_sequences.bed:random_matched_control_HAR,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/primate_UCE.hg19.matched_control_sequences.bed:random_matched_control_consPrimates_UCE,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Catarrhini.matched_control_sequences.bed:random_matched_control_LinAR_Catarrhini,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Hominidae.matched_control_sequences.bed:random_matched_control_LinAR_Hominidae,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Homininae.matched_control_sequences.bed:random_matched_control_LinAR_Homininae,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Hominoidea.matched_control_sequences.bed:random_matched_control_LinAR_Hominoidea,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Human.matched_control_sequences.bed:random_matched_control_LinAR_Human,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/LinAR_Simiformes.matched_control_sequences.bed:random_matched_control_LinAR_Simiformes,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/chimp-AQERs.matched_control_sequences.bed:random_matched_control_CAQERs,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/gorilla-AQERs.matched_control_sequences.bed:random_matched_control_GAQERs,/Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/gene_sets/HAQERs_v2.hg19.matched_control_sequences.bed:random_matched_control_HAQER_v2 \
    --out /Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/pathway_prs/SPARK_ABCD.cogPerf.human_evolution_complement_ESPGSv2
    
# ls /Dedicated/jmichaelson-wdata/lcasten/sli_wgs/prs/pathway_prs/SPARK_ABCD.cogPerf.human_evolution_complement*
